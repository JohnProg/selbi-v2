{
	"rules": {
	    "users" : {
	    	"$uid" : {
	    		".write": "$uid === auth.uid",
                ".read": "$uid === auth.uid",

	    		 ".validate": "newData.hasChildren(['name', 'email', 'userAgreementAccepted'])",

	    		"name": {
                    ".validate": "newData.hasChildren(['first', 'last'])",

                    "first": {
                      ".validate" : "newData.isString()"
                    },
                    "last": {
                      ".validate" : "newData.isString()"
                    }
	    		},

                "profileImageUrl" : {
                    ".validate" : "newData.isString() && newData.val().matches(/^http(s)?:/)"
                },

	    		// TODO: Validate email is valid as well.
	    		"email": {
	    			".validate" : "newData.isString()"
	    		},

                // YYYY-MM-DD
                "dateOfBirth" : {
                  ".validate": "newData.isString() && newData.val().matches(/^(19|20)[0-9][0-9][-\\/. ](0[1-9]|1[012])[-\\/. ](0[1-9]|[12][0-9]|3[01])$/)"
                }
	    	}
	    }
  	}
}
